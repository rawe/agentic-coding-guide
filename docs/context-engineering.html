<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Master Your Context Window</title>
  <link rel="stylesheet" href="css/theme.css">
  <style>
    /* ── Background image & overlay ── */
    body {
      background-image: url('assets/bg-dark-abstract.png');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      background-repeat: no-repeat;
    }

    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background: linear-gradient(
        180deg,
        rgba(10, 14, 26, 0.92) 0%,
        rgba(10, 14, 26, 0.80) 40%,
        rgba(10, 14, 26, 0.88) 100%
      );
      z-index: 0;
    }

    .page-wrapper {
      position: relative;
      z-index: 1;
      max-width: 1200px;
      margin: 0 auto;
      padding: 60px 40px 80px;
    }

    /* ── Header ── */
    header {
      text-align: center;
      margin-bottom: 72px;
    }

    .badge {
      display: inline-block;
      font-family: var(--font-mono);
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 2px;
      text-transform: uppercase;
      color: #38bdf8;
      background: rgba(56, 189, 248, 0.15);
      border: 1px solid rgba(56, 189, 248, 0.2);
      padding: 6px 16px;
      border-radius: 20px;
      margin-bottom: 24px;
    }

    h1 {
      font-size: clamp(2.2rem, 5vw, 3.6rem);
      font-weight: 800;
      line-height: 1.1;
      letter-spacing: -0.03em;
      margin-bottom: 16px;
      background: linear-gradient(135deg, #38bdf8 0%, #a78bfa 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .subtitle {
      font-size: 1.15rem;
      color: var(--text-secondary);
      max-width: 640px;
      margin: 0 auto;
      line-height: 1.6;
      font-weight: 400;
    }

    /* ── Section shared ── */
    .section {
      margin-bottom: 72px;
    }

    .section-card {
      background: var(--bg-card);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border-subtle);
      border-radius: 16px;
      padding: 40px;
    }

    .section-card h2 {
      font-size: 1.4rem;
      font-weight: 700;
      margin-bottom: 8px;
      letter-spacing: -0.02em;
    }

    .section-card .section-intro {
      font-size: 0.95rem;
      color: var(--text-secondary);
      line-height: 1.6;
      margin-bottom: 28px;
      max-width: 700px;
    }

    /* ── Inline code ── */
    code {
      font-family: var(--font-mono);
      font-size: 0.85em;
      color: var(--text-primary);
      background: rgba(255, 255, 255, 0.06);
      padding: 2px 6px;
      border-radius: 4px;
    }

    /* ── Code blocks ── */
    .code-block {
      background: rgba(0, 0, 0, 0.4);
      border: 1px solid var(--border-subtle);
      border-radius: 10px;
      padding: 20px 24px;
      font-family: var(--font-mono);
      font-size: 0.8rem;
      line-height: 1.7;
      color: var(--text-secondary);
      overflow-x: auto;
      margin-top: 16px;
      white-space: pre-wrap;
    }

    .code-block .comment { color: var(--text-muted); }
    .code-block .keyword { color: #38bdf8; }
    .code-block .string  { color: var(--plan-primary); }
    .code-block .file-name { color: #38bdf8; }
    .code-block .folder-name { color: #f59e0b; }
    .code-block .frontmatter { color: var(--skills-primary); }
    .code-block .argument { color: #f59e0b; }
    .code-block .cmd { color: #a78bfa; }

    /* ── Callout ── */
    .callout {
      margin-top: 24px;
      padding: 20px 24px;
      border-radius: 10px;
      background: linear-gradient(160deg, rgba(56, 189, 248, 0.06) 0%, rgba(15, 20, 35, 0.6) 100%);
      border: 1px solid rgba(56, 189, 248, 0.15);
      border-left: 3px solid #38bdf8;
      font-size: 0.88rem;
      color: var(--text-secondary);
      line-height: 1.6;
    }

    .callout strong {
      color: #38bdf8;
    }

    .callout.callout-purple {
      background: linear-gradient(160deg, rgba(167, 139, 250, 0.06) 0%, rgba(15, 20, 35, 0.6) 100%);
      border: 1px solid rgba(167, 139, 250, 0.15);
      border-left: 3px solid #a78bfa;
    }

    .callout.callout-purple strong {
      color: #a78bfa;
    }

    /* ── Section 1: 7-Component Layer Diagram ── */
    .component-stack {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 28px;
      max-width: 700px;
    }

    .component-layer {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 14px 20px;
      border-radius: 10px;
      border: 1px solid var(--border-subtle);
      transition: border-color 0.2s ease;
    }

    .component-layer:hover {
      border-color: rgba(56, 189, 248, 0.2);
    }

    .component-layer .layer-num {
      font-family: var(--font-mono);
      font-size: 0.7rem;
      font-weight: 700;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .component-layer:nth-child(1) { background: linear-gradient(160deg, rgba(56, 189, 248, 0.08) 0%, rgba(15, 20, 35, 0.4) 100%); }
    .component-layer:nth-child(1) .layer-num { background: rgba(56, 189, 248, 0.15); color: #38bdf8; border: 1.5px solid #38bdf8; }
    .component-layer:nth-child(2) { background: linear-gradient(160deg, rgba(56, 189, 248, 0.06) 0%, rgba(15, 20, 35, 0.4) 100%); }
    .component-layer:nth-child(2) .layer-num { background: rgba(56, 189, 248, 0.15); color: #38bdf8; border: 1.5px solid rgba(56, 189, 248, 0.6); }
    .component-layer:nth-child(3) { background: linear-gradient(160deg, rgba(124, 110, 240, 0.06) 0%, rgba(15, 20, 35, 0.4) 100%); }
    .component-layer:nth-child(3) .layer-num { background: rgba(124, 110, 240, 0.15); color: var(--skills-primary); border: 1.5px solid var(--skills-primary); }
    .component-layer:nth-child(4) { background: linear-gradient(160deg, rgba(167, 139, 250, 0.06) 0%, rgba(15, 20, 35, 0.4) 100%); }
    .component-layer:nth-child(4) .layer-num { background: rgba(167, 139, 250, 0.15); color: #a78bfa; border: 1.5px solid #a78bfa; }
    .component-layer:nth-child(5) { background: linear-gradient(160deg, rgba(167, 139, 250, 0.05) 0%, rgba(15, 20, 35, 0.4) 100%); }
    .component-layer:nth-child(5) .layer-num { background: rgba(196, 102, 245, 0.15); color: var(--mcp-primary); border: 1.5px solid var(--mcp-primary); }
    .component-layer:nth-child(6) { background: linear-gradient(160deg, rgba(196, 102, 245, 0.05) 0%, rgba(15, 20, 35, 0.4) 100%); }
    .component-layer:nth-child(6) .layer-num { background: rgba(196, 102, 245, 0.12); color: var(--mcp-primary); border: 1.5px solid rgba(196, 102, 245, 0.6); }
    .component-layer:nth-child(7) { background: linear-gradient(160deg, rgba(52, 211, 153, 0.05) 0%, rgba(15, 20, 35, 0.4) 100%); }
    .component-layer:nth-child(7) .layer-num { background: var(--plan-glow); color: var(--plan-primary); border: 1.5px solid var(--plan-primary); }

    .component-layer .layer-name {
      font-size: 0.88rem;
      font-weight: 600;
      color: var(--text-primary);
      min-width: 160px;
    }

    .component-layer .layer-desc {
      font-size: 0.82rem;
      color: var(--text-muted);
      line-height: 1.4;
    }

    /* ── Section 2: Token Budget Meter ── */
    .token-meter {
      margin-top: 28px;
      padding: 28px;
      border-radius: 12px;
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid var(--border-subtle);
    }

    .meter-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .meter-title {
      font-family: var(--font-mono);
      font-size: 0.75rem;
      font-weight: 600;
      letter-spacing: 1.5px;
      text-transform: uppercase;
      color: #38bdf8;
    }

    .meter-capacity {
      font-family: var(--font-mono);
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    .meter-bar {
      width: 100%;
      height: 32px;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid var(--border-subtle);
      overflow: hidden;
      display: flex;
    }

    .meter-segment {
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: var(--font-mono);
      font-size: 0.6rem;
      font-weight: 600;
      color: rgba(255, 255, 255, 0.8);
      white-space: nowrap;
      overflow: hidden;
      transition: width 0.5s ease;
    }

    .meter-segment.seg-history { background: rgba(56, 189, 248, 0.35); width: 25%; }
    .meter-segment.seg-files { background: rgba(167, 139, 250, 0.35); width: 20%; }
    .meter-segment.seg-tools { background: rgba(124, 110, 240, 0.35); width: 10%; }
    .meter-segment.seg-instructions { background: rgba(52, 211, 153, 0.3); width: 8%; }
    .meter-segment.seg-output { background: rgba(245, 158, 11, 0.3); width: 12%; }
    .meter-segment.seg-headroom { background: transparent; width: 25%; }

    .meter-legend {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      margin-top: 14px;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 0.72rem;
      color: var(--text-muted);
    }

    .legend-dot {
      width: 8px;
      height: 8px;
      border-radius: 2px;
      flex-shrink: 0;
    }

    .meter-threshold {
      position: relative;
      margin-top: 8px;
      height: 20px;
    }

    .threshold-line {
      position: absolute;
      left: 75%;
      top: 0;
      bottom: 0;
      width: 1px;
      background: var(--warn);
      opacity: 0.6;
    }

    .threshold-label {
      position: absolute;
      left: 75%;
      top: 2px;
      transform: translateX(6px);
      font-family: var(--font-mono);
      font-size: 0.6rem;
      color: var(--warn);
      white-space: nowrap;
      opacity: 0.7;
    }

    /* ── Section 3: Control Stack ── */
    .control-stack {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-top: 28px;
    }

    .control-layer {
      display: grid;
      grid-template-columns: 140px 1fr auto;
      align-items: center;
      gap: 20px;
      padding: 18px 24px;
      border-radius: 12px;
      border: 1px solid var(--border-subtle);
    }

    .control-layer .cl-label {
      font-family: var(--font-mono);
      font-size: 0.72rem;
      font-weight: 600;
      letter-spacing: 1px;
      text-transform: uppercase;
    }

    .control-layer .cl-feature {
      font-size: 0.88rem;
      font-weight: 600;
      color: var(--text-primary);
    }

    .control-layer .cl-feature span {
      display: block;
      font-size: 0.8rem;
      font-weight: 400;
      color: var(--text-muted);
      margin-top: 2px;
    }

    .control-layer .cl-example {
      font-family: var(--font-mono);
      font-size: 0.72rem;
      color: var(--text-muted);
      text-align: right;
      white-space: nowrap;
    }

    .control-layer.cl-always {
      background: linear-gradient(160deg, rgba(56, 189, 248, 0.08) 0%, rgba(15, 20, 35, 0.5) 100%);
      border-left: 3px solid #38bdf8;
    }
    .control-layer.cl-always .cl-label { color: #38bdf8; }

    .control-layer.cl-scoped {
      background: linear-gradient(160deg, rgba(56, 189, 248, 0.05) 0%, rgba(15, 20, 35, 0.5) 100%);
      border-left: 3px solid rgba(56, 189, 248, 0.6);
    }
    .control-layer.cl-scoped .cl-label { color: rgba(56, 189, 248, 0.8); }

    .control-layer.cl-ondemand {
      background: linear-gradient(160deg, rgba(124, 110, 240, 0.06) 0%, rgba(15, 20, 35, 0.5) 100%);
      border-left: 3px solid var(--skills-primary);
    }
    .control-layer.cl-ondemand .cl-label { color: var(--skills-primary); }

    .control-layer.cl-runtime {
      background: linear-gradient(160deg, rgba(167, 139, 250, 0.05) 0%, rgba(15, 20, 35, 0.5) 100%);
      border-left: 3px solid #a78bfa;
    }
    .control-layer.cl-runtime .cl-label { color: #a78bfa; }

    .control-layer.cl-isolated {
      background: linear-gradient(160deg, rgba(196, 102, 245, 0.05) 0%, rgba(15, 20, 35, 0.5) 100%);
      border-left: 3px solid var(--mcp-primary);
    }
    .control-layer.cl-isolated .cl-label { color: var(--mcp-primary); }

    .control-layer.cl-hooks {
      background: linear-gradient(160deg, rgba(52, 211, 153, 0.05) 0%, rgba(15, 20, 35, 0.5) 100%);
      border-left: 3px solid var(--plan-primary);
    }
    .control-layer.cl-hooks .cl-label { color: var(--plan-primary); }

    /* ── Section 4: Tip Cards Grid ── */
    .tip-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-top: 28px;
    }

    .tip-card {
      padding: 24px;
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid var(--border-subtle);
    }

    .tip-card h4 {
      font-size: 0.95rem;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 8px;
    }

    .tip-card p {
      font-size: 0.85rem;
      color: var(--text-secondary);
      line-height: 1.6;
    }

    .tip-card .tip-tag {
      font-family: var(--font-mono);
      font-size: 0.65rem;
      font-weight: 600;
      letter-spacing: 1px;
      text-transform: uppercase;
      padding: 3px 8px;
      border-radius: 4px;
      display: inline-block;
      margin-bottom: 12px;
    }

    .tip-card .tip-tag.tag-blue {
      color: #38bdf8;
      background: rgba(56, 189, 248, 0.15);
    }

    .tip-card .tip-tag.tag-purple {
      color: #a78bfa;
      background: rgba(167, 139, 250, 0.15);
    }

    .tip-card .tip-tag.tag-green {
      color: var(--plan-primary);
      background: var(--plan-glow);
    }

    /* ── Section 5: Anti-pattern Cards ── */
    .antipattern-list {
      display: flex;
      flex-direction: column;
      gap: 16px;
      margin-top: 28px;
    }

    .antipattern {
      padding: 24px 28px;
      border-radius: 12px;
      border: 1px solid var(--border-subtle);
      background: linear-gradient(160deg, rgba(240, 110, 110, 0.04) 0%, rgba(15, 20, 35, 0.5) 100%);
      border-left: 3px solid var(--warn);
    }

    .antipattern h4 {
      font-size: 0.95rem;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 6px;
    }

    .antipattern .ap-desc {
      font-size: 0.85rem;
      color: var(--text-secondary);
      line-height: 1.6;
      margin-bottom: 10px;
    }

    .antipattern .ap-fix {
      font-size: 0.82rem;
      color: var(--plan-primary);
      line-height: 1.5;
    }

    .antipattern .ap-fix strong {
      color: var(--plan-primary);
    }

    /* ── Section 6: Strategy List ── */
    .strategy-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-top: 28px;
    }

    .strategy-card {
      padding: 24px;
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid var(--border-subtle);
    }

    .strategy-card h4 {
      font-size: 0.95rem;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 8px;
    }

    .strategy-card p {
      font-size: 0.85rem;
      color: var(--text-secondary);
      line-height: 1.6;
    }

    .strategy-card .code-block {
      margin-top: 12px;
      font-size: 0.75rem;
      padding: 14px 18px;
    }

    /* ── IO Grid (Before/After) ── */
    .io-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      margin-top: 28px;
    }

    .io-card {
      border-radius: 12px;
      padding: 24px;
      border: 1px solid var(--border-subtle);
    }

    .io-card.input-card {
      background: linear-gradient(160deg, rgba(240, 110, 110, 0.06) 0%, rgba(15, 20, 35, 0.6) 100%);
      border-left: 3px solid var(--warn);
    }

    .io-card.output-card {
      background: linear-gradient(160deg, rgba(52, 211, 153, 0.06) 0%, rgba(15, 20, 35, 0.6) 100%);
      border-left: 3px solid var(--plan-primary);
    }

    .io-card h4 {
      font-family: var(--font-mono);
      font-size: 0.7rem;
      font-weight: 600;
      letter-spacing: 1.5px;
      text-transform: uppercase;
      margin-bottom: 14px;
    }

    .io-card.input-card h4 { color: var(--warn); }
    .io-card.output-card h4 { color: var(--plan-primary); }

    .io-card ul {
      list-style: none;
    }

    .io-card ul li {
      font-size: 0.82rem;
      color: var(--text-secondary);
      padding: 4px 0 4px 18px;
      position: relative;
      line-height: 1.5;
    }

    .io-card ul li::before {
      content: '\2022';
      position: absolute;
      left: 0;
      color: var(--text-muted);
    }

    /* ── Source attribution ── */
    .source-attribution {
      position: fixed;
      bottom: 20px;
      left: 24px;
      z-index: 10;
      font-family: var(--font-mono);
      font-size: 0.7rem;
      color: var(--text-muted);
      line-height: 1.5;
      opacity: 0.6;
      transition: opacity 0.3s ease;
    }

    .source-attribution:hover {
      opacity: 1;
    }

    .source-attribution a {
      color: var(--text-muted);
      text-decoration: none;
    }

    .source-attribution a:hover {
      color: var(--text-secondary);
    }

    /* ── Responsive ── */
    @media (max-width: 960px) {
      .control-layer {
        grid-template-columns: 120px 1fr;
      }
      .control-layer .cl-example {
        grid-column: 1 / -1;
        text-align: left;
      }
    }

    @media (max-width: 700px) {
      .tip-grid { grid-template-columns: 1fr; }
      .strategy-grid { grid-template-columns: 1fr; }
      .io-grid { grid-template-columns: 1fr; }
      .component-layer {
        flex-direction: column;
        align-items: flex-start;
        gap: 6px;
      }
      .component-layer .layer-name {
        min-width: auto;
      }
      .control-layer {
        grid-template-columns: 1fr;
        gap: 8px;
      }
      .control-layer .cl-example {
        text-align: left;
      }
    }

    @media (max-width: 600px) {
      .page-wrapper {
        padding: 40px 20px 60px;
      }

      .section-card {
        padding: 28px 20px;
      }

      .meter-bar {
        height: 24px;
      }

      .meter-segment {
        font-size: 0;
      }
    }
  </style>
</head>
<body>

<div class="page-wrapper">

  <!-- Header -->
  <header>
    <div class="badge">Context Engineering</div>
    <h1>Master Your Context Window</h1>
    <p class="subtitle">
      What goes in, what stays out, and why it decides everything.
    </p>
  </header>

  <!-- Section 1: From Prompt Engineering to Context Engineering -->
  <div class="section">
    <div class="section-card">
      <h2>From Prompt Engineering to Context Engineering</h2>
      <p class="section-intro">
        In mid-2025, Tobi Lutke and Andrej Karpathy popularized a reframe: you're not just writing a prompt &mdash; you're engineering the entire information environment the model sees at inference time. The term "prompt engineering" trivialized what is actually a systems design problem.
      </p>

      <p style="font-size: 0.88rem; color: var(--text-secondary); line-height: 1.6; margin-bottom: 24px;">
        Phil Schmid formalized a 7-component model: everything the model can see when it generates a response. Each component is a lever you can control. Understanding all seven is the foundation of working effectively with coding agents.
      </p>

      <div class="component-stack">
        <div class="component-layer">
          <div class="layer-num">1</div>
          <div class="layer-name">Instructions</div>
          <div class="layer-desc">System prompts, CLAUDE.md, rules files &mdash; persistent guidance</div>
        </div>
        <div class="component-layer">
          <div class="layer-num">2</div>
          <div class="layer-name">User Prompt</div>
          <div class="layer-desc">Your current request &mdash; the task description and constraints</div>
        </div>
        <div class="component-layer">
          <div class="layer-num">3</div>
          <div class="layer-name">Conversation History</div>
          <div class="layer-desc">All prior turns in the session &mdash; grows with every exchange</div>
        </div>
        <div class="component-layer">
          <div class="layer-num">4</div>
          <div class="layer-name">Long-term Memory</div>
          <div class="layer-desc">Persistent facts recalled across sessions &mdash; user preferences, project conventions</div>
        </div>
        <div class="component-layer">
          <div class="layer-num">5</div>
          <div class="layer-name">Retrieved Information</div>
          <div class="layer-desc">File reads, search results, web fetches &mdash; pulled at runtime</div>
        </div>
        <div class="component-layer">
          <div class="layer-num">6</div>
          <div class="layer-name">Available Tools</div>
          <div class="layer-desc">Tool definitions, MCP servers &mdash; each tool schema consumes tokens</div>
        </div>
        <div class="component-layer">
          <div class="layer-num">7</div>
          <div class="layer-name">Output Format</div>
          <div class="layer-desc">Structured output schemas, response templates &mdash; shapes generation</div>
        </div>
      </div>

      <div class="callout" style="margin-top: 28px;">
        <strong>Tobi Lutke:</strong> "Context engineering is the art of providing all the context for the task to be plausibly solvable by the LLM."
      </div>
    </div>
  </div>

  <!-- Section 2: The Context Window as Finite Resource -->
  <div class="section">
    <div class="section-card">
      <h2>The Context Window as Finite Resource</h2>
      <p class="section-intro">
        Think of the context window as working memory. It has a hard capacity limit, and performance degrades as it fills &mdash; not linearly, but noticeably past ~75% utilization. Transformer attention spreads thin across n&sup2; token pairs. More tokens means weaker attention on the tokens that matter.
      </p>

      <div class="token-meter">
        <div class="meter-header">
          <span class="meter-title">Token Budget &mdash; Typical Session</span>
          <span class="meter-capacity">200k context window</span>
        </div>
        <div class="meter-bar">
          <div class="meter-segment seg-history">History</div>
          <div class="meter-segment seg-files">File reads</div>
          <div class="meter-segment seg-tools">Tools</div>
          <div class="meter-segment seg-instructions">CLAUDE.md</div>
          <div class="meter-segment seg-output">Reasoning</div>
          <div class="meter-segment seg-headroom"></div>
        </div>
        <div class="meter-threshold">
          <div class="threshold-line"></div>
          <span class="threshold-label">75% &mdash; performance degrades</span>
        </div>
        <div class="meter-legend">
          <div class="legend-item"><div class="legend-dot" style="background: rgba(56, 189, 248, 0.5);"></div> Conversation history</div>
          <div class="legend-item"><div class="legend-dot" style="background: rgba(167, 139, 250, 0.5);"></div> File reads</div>
          <div class="legend-item"><div class="legend-dot" style="background: rgba(124, 110, 240, 0.5);"></div> Tool definitions</div>
          <div class="legend-item"><div class="legend-dot" style="background: rgba(52, 211, 153, 0.45);"></div> Instructions</div>
          <div class="legend-item"><div class="legend-dot" style="background: rgba(245, 158, 11, 0.45);"></div> Reasoning headroom</div>
          <div class="legend-item"><div class="legend-dot" style="background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.1);"></div> Free space</div>
        </div>
      </div>

      <p style="font-size: 0.88rem; color: var(--text-secondary); line-height: 1.6; margin-top: 24px;">
        What fills it fast: a single file read can consume thousands of tokens. Command outputs, conversation turns, and tool schemas all accumulate. The goal from Anthropic's engineering blog: <em>"find the smallest set of high-signal tokens that maximize the likelihood of your desired outcome."</em>
      </p>

      <div class="callout callout-purple" style="margin-top: 20px;">
        <strong>The 40&ndash;60% rule:</strong> The ACE framework recommends keeping context utilization between 40&ndash;60%. Leave headroom for reasoning. Don't maximize token usage &mdash; maximize signal density.
      </div>
    </div>
  </div>

  <!-- Section 3: The Context Control Stack in Claude Code -->
  <div class="section">
    <div class="section-card">
      <h2>The Context Control Stack</h2>
      <p class="section-intro">
        Claude Code's features map directly to context engineering levers. Each one gives you a different way to control what the model sees and when. The hierarchy runs from always-present to fully isolated.
      </p>

      <div class="control-stack">
        <div class="control-layer cl-always">
          <div class="cl-label">Always-on</div>
          <div class="cl-feature">
            CLAUDE.md
            <span>Loaded every session &mdash; keep it lean, treat it like code</span>
          </div>
          <div class="cl-example">~200&ndash;500 tokens</div>
        </div>

        <div class="control-layer cl-scoped">
          <div class="cl-label">Scoped</div>
          <div class="cl-feature">
            Rules files
            <span>Modular project instructions; can be scoped to specific file paths</span>
          </div>
          <div class="cl-example">.claude/rules/</div>
        </div>

        <div class="control-layer cl-ondemand">
          <div class="cl-label">On-demand</div>
          <div class="cl-feature">
            Skills
            <span>Lazy-loaded domain knowledge, triggered by description match</span>
          </div>
          <div class="cl-example">.claude/skills/</div>
        </div>

        <div class="control-layer cl-runtime">
          <div class="cl-label">Runtime</div>
          <div class="cl-feature">
            Tools &amp; MCP servers
            <span>Agent pulls what it needs, when it needs it</span>
          </div>
          <div class="cl-example">tool definitions + results</div>
        </div>

        <div class="control-layer cl-isolated">
          <div class="cl-label">Isolated</div>
          <div class="cl-feature">
            Subagents
            <span>Separate context windows for exploration and review</span>
          </div>
          <div class="cl-example">Task tool &rarr; independent window</div>
        </div>

        <div class="control-layer cl-hooks">
          <div class="cl-label">Zero-cost</div>
          <div class="cl-feature">
            Hooks
            <span>Run scripts deterministically at lifecycle events &mdash; minimal context cost</span>
          </div>
          <div class="cl-example">.claude/settings.json</div>
        </div>
      </div>

      <div class="callout" style="margin-top: 28px;">
        <strong>Mental model:</strong> When you have a context problem, think: <em>which lever do I pull?</em> Need persistent guidance? CLAUDE.md. Need knowledge only sometimes? Skill. Need exploration without pollution? Subagent. Need a side-effect without tokens? Hook.
      </div>
    </div>
  </div>

  <!-- Section 4: Practical Patterns for High-Signal Context -->
  <div class="section">
    <div class="section-card">
      <h2>Practical Patterns for High-Signal Context</h2>
      <p class="section-intro">
        Actionable strategies for keeping signal high and noise low. Each pattern directly controls what enters &mdash; and what stays out of &mdash; the context window.
      </p>

      <div class="tip-grid">
        <div class="tip-card">
          <span class="tip-tag tag-blue">CLAUDE.md</span>
          <h4>Right-size Your CLAUDE.md</h4>
          <p>Only include what Claude can't infer from code. For each line, ask: would removing this cause mistakes? If not, cut it. Prune regularly.</p>
          <div class="code-block" style="font-size: 0.75rem; padding: 14px 18px;">
<span class="comment"># Good: specific, actionable</span>
<span class="keyword">Use uv for all dependencies. Never pip.</span>
<span class="keyword">Run tests with: pytest tests/ -x</span>

<span class="comment"># Bad: obvious, wastes tokens</span>
<span class="string">Write clean, well-documented code.</span>
<span class="string">Follow best practices.</span></div>
        </div>

        <div class="tip-card">
          <span class="tip-tag tag-purple">Subagents</span>
          <h4>Scope Investigations</h4>
          <p>Use subagents for codebase exploration to keep your main context clean. The exploration results stay in the subagent's window &mdash; only the summary returns.</p>
          <div class="code-block" style="font-size: 0.75rem; padding: 14px 18px;">
<span class="comment"># Instead of:</span>
<span class="string">"Read all files in src/ and find the auth logic"</span>

<span class="comment"># Use:</span>
<span class="keyword">"Use a subagent to investigate src/ for</span>
<span class="keyword"> auth patterns, then summarize findings"</span></div>
        </div>

        <div class="tip-card">
          <span class="tip-tag tag-green">Session hygiene</span>
          <h4>Clear Between Tasks</h4>
          <p><code>/clear</code> resets the window. A clean session with a better prompt beats a cluttered session with corrections stacked on corrections.</p>
          <div class="code-block" style="font-size: 0.75rem; padding: 14px 18px;">
<span class="comment"># Finished the auth feature? Clear before starting the next task.</span>
<span class="cmd">/clear</span>

<span class="comment"># Context too bloated mid-task? Compact with intent.</span>
<span class="cmd">/compact</span> <span class="keyword">Focus on the API changes</span></div>
        </div>

        <div class="tip-card">
          <span class="tip-tag tag-blue">Delegation</span>
          <h4>Let Claude Fetch, Don't Pre-load</h4>
          <p>Tell Claude to read files and run commands rather than pasting everything in. Claude fetches selectively; you tend to dump everything.</p>
          <div class="code-block" style="font-size: 0.75rem; padding: 14px 18px;">
<span class="comment"># Instead of pasting 500 lines:</span>
<span class="string">"Here's the whole file: [paste]"</span>

<span class="comment"># Let Claude fetch what it needs:</span>
<span class="keyword">"Fix the validation bug in src/auth.ts"</span>
<span class="comment"># Claude reads only the relevant functions</span></div>
        </div>
      </div>

      <!-- Before / After comparison -->
      <div class="io-grid" style="margin-top: 32px;">
        <div class="io-card input-card">
          <h4>Poor Context Management</h4>
          <ul>
            <li>Pastes entire files into the prompt</li>
            <li>Stacks corrections on a bloated session</li>
            <li>Mixes unrelated tasks without clearing</li>
            <li>Explores the codebase in the main context</li>
            <li>Fills CLAUDE.md with generic advice</li>
          </ul>
        </div>
        <div class="io-card output-card">
          <h4>Good Context Management</h4>
          <ul>
            <li>Describes the task; lets Claude fetch files</li>
            <li>Clears and restarts with a better prompt</li>
            <li>One task per session, <code>/clear</code> between</li>
            <li>Delegates exploration to subagents</li>
            <li>Keeps CLAUDE.md to actionable rules only</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Section 5: Anti-Patterns That Kill Context -->
  <div class="section">
    <div class="section-card">
      <h2>Anti-Patterns That Kill Context</h2>
      <p class="section-intro">
        Common mistakes that fill the context window with noise, presented as recognizable scenarios. Each one has a one-line diagnosis and fix.
      </p>

      <div class="antipattern-list">
        <div class="antipattern">
          <h4>The Kitchen Sink Session</h4>
          <p class="ap-desc">You fixed a bug, then added a feature, then refactored a test &mdash; all in one session. By turn 30, Claude is confused about which task is current, and old file reads from the bug fix are polluting attention for the refactor.</p>
          <p class="ap-fix"><strong>Fix:</strong> <code>/clear</code> between unrelated tasks. One focused session beats one long session.</p>
        </div>

        <div class="antipattern">
          <h4>The Correction Spiral</h4>
          <p class="ap-desc">Claude made a mistake. You corrected it. Claude made a different mistake. You corrected that too. Five corrections later, the context is full of wrong approaches and conflicting instructions. Claude is now attending to the mistakes as much as the corrections.</p>
          <p class="ap-fix"><strong>Fix:</strong> After two corrections, stop. <code>/clear</code> and write a better initial prompt that prevents the mistake.</p>
        </div>

        <div class="antipattern">
          <h4>The Bloated CLAUDE.md</h4>
          <p class="ap-desc">Your CLAUDE.md has 200 lines covering every conceivable scenario. Half the rules contradict each other, and Claude can't tell which ones matter for the current task. When everything is important, nothing is.</p>
          <p class="ap-fix"><strong>Fix:</strong> Cut to &lt;50 lines. Move domain-specific guidance to rules files or skills. If removing a line doesn't cause errors, delete it.</p>
        </div>

        <div class="antipattern">
          <h4>The Infinite Exploration</h4>
          <p class="ap-desc">You asked Claude to "investigate the authentication system." Without scope constraints, it reads 30 files, fills the context with irrelevant module internals, and returns a meandering summary that buries the answer you needed.</p>
          <p class="ap-fix"><strong>Fix:</strong> Scope investigations: "Read <code>src/auth/login.ts</code> and explain how tokens are validated." Or delegate open-ended exploration to a subagent.</p>
        </div>

        <div class="antipattern">
          <h4>The Pre-loaded Dump</h4>
          <p class="ap-desc">You paste three entire files into your prompt "for context." Claude now has 4,000 tokens of code it may not need, displacing space for the reasoning and file reads it actually requires.</p>
          <p class="ap-fix"><strong>Fix:</strong> Describe the task and let Claude fetch what it needs. It reads selectively; you dump indiscriminately.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Section 6: Context Engineering for Large Codebases -->
  <div class="section">
    <div class="section-card">
      <h2>Context Engineering for Large Codebases</h2>
      <p class="section-intro">
        Strategies that scale beyond small projects. At 100k+ lines of code, context management stops being a nice-to-have and becomes the primary determinant of agent effectiveness.
      </p>

      <div class="strategy-grid">
        <div class="strategy-card">
          <h4>Divide Investigation with Subagents</h4>
          <p>Split codebase exploration across modules. Each subagent gets its own context window and returns a focused summary. The main context stays clean.</p>
          <div class="code-block">
<span class="comment"># Fan out investigation</span>
<span class="keyword">"Use subagents to investigate:</span>
<span class="keyword"> 1. The auth module in src/auth/</span>
<span class="keyword"> 2. The API routes in src/api/</span>
<span class="keyword"> 3. The database layer in src/db/</span>
<span class="keyword"> Then synthesize findings."</span></div>
        </div>

        <div class="strategy-card">
          <h4>Create Research Artifacts</h4>
          <p>Summarize findings into compressed research.md files. These serve as context anchors for future sessions &mdash; the investigation cost is paid once, reused many times.</p>
          <div class="code-block">
<span class="comment"># Research artifact</span>
<span class="file-name">research/auth-architecture.md</span>
<span class="comment">  Token flow: login → /api/token → JWT</span>
<span class="comment">  Middleware: src/middleware/auth.ts</span>
<span class="comment">  Key constraint: tokens expire in 1h</span></div>
        </div>

        <div class="strategy-card">
          <h4>Write Skills for Domain Knowledge</h4>
          <p>Encode domain-specific workflows as skills so they load only when relevant. Zero cost when dormant, full instructions when activated.</p>
          <div class="code-block">
<span class="comment"># Instead of 50 lines in CLAUDE.md:</span>
<span class="folder-name">.claude/skills/deploy-workflow/</span>
<span class="comment">  SKILL.md  # loaded only for deploy tasks</span></div>
        </div>

        <div class="strategy-card">
          <h4>Exclude Noise with .gitignore</h4>
          <p>Claude Code respects .gitignore patterns. Keep generated files, build artifacts, and irrelevant directories out of context. Every excluded file is tokens saved for the files that matter.</p>
          <div class="code-block">
<span class="comment"># .gitignore (also respected by Claude Code)</span>
<span class="keyword">dist/</span>
<span class="keyword">node_modules/</span>
<span class="keyword">*.generated.ts</span>
<span class="keyword">coverage/</span></div>
        </div>

        <div class="strategy-card">
          <h4>Fan Out with <code>claude -p</code></h4>
          <p>For batch operations across many files, use headless mode. Each invocation gets a fresh context window &mdash; no cross-contamination between files.</p>
          <div class="code-block">
<span class="comment"># Batch process across files</span>
<span class="cmd">for f in src/api/*.ts; do</span>
<span class="cmd">  claude -p</span> <span class="string">"Add input validation to $f"</span>
<span class="cmd">done</span></div>
        </div>

        <div class="strategy-card">
          <h4>Compress with Intentional Compaction</h4>
          <p>When context is deep in a long session, use <code>/compact</code> with a focus directive. Claude preserves what matters and discards what doesn't.</p>
          <div class="code-block">
<span class="comment"># Targeted compaction</span>
<span class="cmd">/compact</span> <span class="keyword">Retain the database schema</span>
<span class="keyword">changes and the migration plan.</span>
<span class="keyword">Drop the earlier debugging.</span></div>
        </div>
      </div>

      <div class="callout" style="margin-top: 28px;">
        <strong>300k LOC example:</strong> Practitioners shipping complex features in large Rust codebases report that structured context management &mdash; subagent investigation, research artifacts, and intentional compaction &mdash; is the difference between the agent succeeding and failing. The model capability is the same; the context engineering determines the outcome.
      </div>
    </div>
  </div>

</div>

<!-- Source attribution bottom-left -->
<div class="source-attribution">
  Multiple sources<br>
  <a href="https://www.anthropic.com/engineering/effective-context-engineering-for-ai-agents" target="_blank" rel="noopener">Anthropic Engineering</a> &middot;
  <a href="https://www.philschmid.de/context-engineering" target="_blank" rel="noopener">Phil Schmid</a> &middot;
  <a href="https://github.com/humanlayer/advanced-context-engineering-for-coding-agents/blob/main/ace-fca.md" target="_blank" rel="noopener">ACE Guide</a>
</div>

</body>
</html>
